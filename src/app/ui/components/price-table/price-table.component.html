<p-table
  [value]="rows"
  [scrollable]="true"
  scrollHeight="60vh"
  [virtualScroll]="useVirtualScroll"
  [virtualScrollItemSize]="42"
  [paginator]="!useVirtualScroll"
  [rows]="50"
  [customSort]="true"
  (sortFunction)="onSort($event)"
  styleClass="price-table"
  [tableStyle]="{ 'min-width': '1100px' }"
>
  <ng-template pTemplate="header">
    <tr>
      <th pSortableColumn="itemName">
        Item
        <p-sortIcon field="itemName"></p-sortIcon>
      </th>
      <th *ngFor="let server of servers" [pSortableColumn]="'server:' + server">
        {{ server }}
        <p-sortIcon [field]="'server:' + server"></p-sortIcon>
      </th>
      <th class="source-col" pSortableColumn="sourcePrice">
        Source
        <p-sortIcon field="sourcePrice"></p-sortIcon>
      </th>
      <th class="target-col" pSortableColumn="targetPrice">
        Cible
        <p-sortIcon field="targetPrice"></p-sortIcon>
      </th>
      <th pSortableColumn="netSpread">
        Net
        <p-sortIcon field="netSpread"></p-sortIcon>
      </th>
      <th pSortableColumn="profitPercent">
        Profit %
        <p-sortIcon field="profitPercent"></p-sortIcon>
      </th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-row>
    <tr>
      <td class="item">{{ row.itemName }}</td>
      <td *ngFor="let server of servers" [ngClass]="cellClass(row, server)">
        {{ row.pricesByServer[server] | price }}
      </td>
      <td class="source-col source-cell">
        <span class="server-label" *ngIf="row.sourceServer">{{ row.sourceServer }}</span>
        {{ row.sourcePrice | price }}
      </td>
      <td class="target-col target-cell">
        <span class="server-label" *ngIf="row.targetServer">{{ row.targetServer }}</span>
        {{ row.targetPrice | price }}
      </td>
      <td class="net-cell" [ngClass]="{ 'delta-pos': row.netSpread !== null && row.netSpread > 0, 'delta-neg': row.netSpread !== null && row.netSpread < 0 }">
        {{ row.netSpread | price }}
      </td>
      <td class="profit-cell" [ngStyle]="profitStyle(row)">
        <span *ngIf="row.profitPercent !== null">
          {{ row.profitPercent | percent: '1.1-1' }}
        </span>
        <span *ngIf="row.profitPercent === null">-</span>
      </td>
    </tr>
  </ng-template>
  <ng-template pTemplate="emptymessage">
    <tr>
      <td [attr.colspan]="servers.length + 5">No rows to display.</td>
    </tr>
  </ng-template>
</p-table>
